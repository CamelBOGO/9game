<html>
    <head>
        <title> 
            9Game 
        </title>
    </head>

    <body>
        <h1> Register </h1>
        <form action = "/register" method = "post">
            <div>
                <label for="name">Name </label>
                <input type="text" id="name" name="name" required>
            </div>

            <div>
                <label for="username">Username </label>
                <input type="text" id="username" name="name" required>
            </div>
        
            <div>
                <label for="email">Email </label>
                <input type="email" id="email" name="email" required>
            </div>
        
            <div>
                <label for="password">Password </label>
                <input type="password" id="password" name="password" required>
            </div>
        
            <button type="submit">Register</button>
        
        </form>

        <a href = "/login"> Already have an account</a>
        
    </body>

	<script>
		function doRegister(form) {
			form.submit.setAttribute("disabled", "disabled");
			form.submit.innerHTML = "<span>Loading...</span>";

			const ajax = new XMLHttpRequest();
			ajax.open("POST", "/register", true);

			ajax.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					form.submit.removeAttribute("disabled");
					form.submit.innerHTML = "<span>Register</span>";

					const response = JSON.parse(this.responseText);
					alert(response.message);

					if (response.status == "success") {
						window.location.href = "/login";
					}
				}
			};

			ajax.send(new FormData(form));
			return false;
		}
	</script>

</html>